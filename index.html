<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æ”¶ä»¶ä¿¡æ¯ä¸€é”®åˆ†åˆ—å°å·¥å…·</title>
<style>
body {
  font-family: "Segoe UI", sans-serif;
  margin: 40px;
  background: #f8f9fa;
  color: #333;
}
h2 { color: #2b6cb0; }
textarea, pre { width: 100%; font-size: 14px; }
textarea {
  height: 180px;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 8px;
  resize: vertical;
}
button {
  margin: 10px 6px 10px 0;
  padding: 10px 18px;
  font-size: 15px;
  border-radius: 8px;
  border: none;
  background: #3182ce;
  color: white;
  cursor: pointer;
  transition: background 0.2s, transform 0.2s;
}
button:hover { background: #2563eb; transform: translateY(-1px); }
pre {
  background: #fff;
  border: 1px solid #ccc;
  padding: 10px;
  border-radius: 8px;
  white-space: pre-wrap;
  min-height: 120px;
}
.note { color: #666; font-size: 13px; }
#toast {
  position: fixed;
  top: 20px;
  right: 20px;
  background: #48bb78;
  color: white;
  padding: 10px 20px;
  border-radius: 8px;
  opacity: 0;
  transition: opacity 0.4s ease;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  pointer-events: none;
}
</style>
</head>
<body>
<h2>ğŸ“¦ æ”¶ä»¶ä¿¡æ¯ â†’ Excelä¸‰åˆ—æ ¼å¼ ä¸€é”®è½¬æ¢å¹¶å¤åˆ¶</h2>
<p>è¯·ç²˜è´´åŸå§‹çš„æ—¥æœ¬æ”¶ä»¶ä¿¡æ¯ï¼ˆæ¯ä¸ªæ”¶ä»¶ä¹‹é—´ç©ºä¸€è¡Œï¼‰ï¼š</p>

<textarea id="input" placeholder=""></textarea>

<div>
  <button onclick="convertAndCopy()">ğŸš€ ä¸€é”®è½¬æ¢å¹¶å¤åˆ¶</button>
  <button onclick="clearAll()" style="background:#e53e3e;">ğŸ§¹ æ¸…ç©º</button>
</div>

<pre id="output" placeholder="è½¬æ¢ç»“æœä¼šå‡ºç°åœ¨è¿™é‡Œ~"></pre>
<p class="note">æç¤ºï¼šè¾“å‡ºå†…å®¹ä¸­çš„åˆ¶è¡¨ç¬¦ï¼ˆTabï¼‰å¯ç›´æ¥è®©Excelåˆ†æˆä¸‰åˆ—~</p>

<div id="toast">âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼</div>

<script>
function convertAndCopy() {
  const input = document.getElementById('input').value.trim();
  const output = document.getElementById('output');
  const blocks = input.split(/\n\s*\n/);
  let result = "";
  blocks.forEach(block => {
    const lines = block.split(/\n/).map(l => l.trim()).filter(l => l);
    if (lines.length >= 3) {
      const postal = lines[0];
      const name = lines[lines.length - 1].replace(/\s*æ§˜$/, "");
      const address = lines.slice(1, -1).join(" ");
      result += `${name}\t${postal}\t${address}\n`;
    }
  });
  output.textContent = result || "ï¼ˆæ²¡æœ‰æ£€æµ‹åˆ°æœ‰æ•ˆä¿¡æ¯ï¼Œè¯·æ£€æŸ¥æ ¼å¼ï¼‰";

  if (result.trim()) {
    navigator.clipboard.writeText(result).then(() => showToast("âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼"));
  } else {
    showToast("âš ï¸ æ²¡æœ‰æ£€æµ‹åˆ°æœ‰æ•ˆå†…å®¹");
  }
}

function showToast(message) {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.style.opacity = 1;
  setTimeout(() => { toast.style.opacity = 0; }, 1800);
}

function clearAll() {
  document.getElementById('input').value = "";
  document.getElementById('output').textContent = "";
  showToast("ğŸ§¹ å·²æ¸…ç©º");
}
</script>
</body>
</html>
